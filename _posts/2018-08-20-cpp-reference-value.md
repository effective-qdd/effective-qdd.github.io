---
layout: post
title: c++ 值类别
date: 2018-8-20
categories: cpp
tags: reference
excerpt: 目前c++有三种基本值类别：纯右值（prvalue，pure rvalue）、亡值（xvalue，eXpiring value）、左值（lvalue， left value）。
mathjax: true
---

# 值类别

* 泛左值（glvalue，generalized lvalue）是其求值确定一个对象、位域或函数的个体的表达式；
* 纯右值（prvalue）是这样的表达式，其求值
  * 计算某个运算符的操作数的值（这种纯右值没有结果对象），或者
  * 初始化某个对象或位域（这种纯右值具有结果对象）。所有类和数组的纯右值都拥有结果对象，即使它被舍弃。
* 亡值（xvalue）是代表其资源能够被重新使用的对象或位域的泛左值；
* 左值（lvalue）是非亡值的泛左值；
* 右值（rvalue）是纯右值或者亡值。

> 左值、亡值和纯右值，它们表征了表达式的属性，而这种属性的区别主要体现在使用上，如能否做运算符的左操作数、能否使用移动语义。左值可以看作“对象”，右值可以看作“值”。但是不能简单的通过“=”来区分左值和右值。

## 左值

有名字的变量一定是左值。如：int a = 0; a是左值。
进一步来讲，能够用&取地址的是左值表达式。左值也可以理解为Location Value，表示在内存中可以寻址，赋值
**字符串字面值是左值，如“abc”是左值，因为它可以取地址，但是不能被赋值。**
常见左值表达式：

```c++
a = b, a += b；
++i, --i; //是左值
*p;

字符串字面值，例如 "Hello, world!"；

Foo &retFoo(); //返回一个引用，retFoo调用是一个左值
Foo f1;
retFoo() = f; //正确， retFoo()返回一个左值
```

## 纯右值

纯粹的字面值。如：1是纯右值
求值结果相当于字面值或是一个不具名的临时对象。纯右值也可以理解为Read Value。可以读出值。
常见纯右值表达式：

```c++
i++, i--; //是纯右值

a + b, a % b，和其他内建的算术表达式

字面值（除字符串字面值）。1, true, nullptr;
&a;
a.m; //对象成员表达式

Lambda表达式，[](int x){ return x * x; }
Foo retVal(); //返回一个值，retval调用时一个右值
```

## 亡值

在C++11之前的右值和C++11中的纯右值是等价的。C++11中的将亡值是随着右值引用的引入而新引入的。

* 返回右值引用的函数的调用表达式
* 转换为右值引用的转换函数的调用表达式。比如返回右值引用T&&的函数返回值、std::move的返回值，或者转换为T&&的类型转换函数的返回值。

常见亡值表达式：

```c++
函数调用或重载运算符表达式，其返回类型为右值引用，例如 std::move(x);
```